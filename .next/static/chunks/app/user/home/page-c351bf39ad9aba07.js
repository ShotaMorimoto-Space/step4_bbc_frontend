(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[927],{9286:function(e,t,l){Promise.resolve().then(l.bind(l,4351))},4351:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return p}});var s=l(7437),a=l(2265);l(2535);var r=l(8094),o=l(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,o.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var n=l(1005),c=l(2023),d=l(2022);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,o.Z)("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);var h=l(6463),x=l(4817);let m=e=>{let{children:t,searchQuery:l,onSearchChange:a,profileImageUrl:r}=e,o=(0,h.useRouter)();return(0,s.jsxs)("div",{className:"w-full max-w-[430px] lg:max-w-6xl xl:max-w-7xl mx-auto bg-white shadow-2xl overflow-hidden min-h-100dvh h-100dvh relative",children:[(0,s.jsxs)("div",{className:"absolute inset-0",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-violet-400 via-violet-600 to-violet-800"}),(0,s.jsx)("div",{className:"absolute inset-0 opacity-5",children:(0,s.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"\n              linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%),\n              linear-gradient(-45deg, rgba(255,255,255,0.1) 25%, transparent 25%),\n              linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.1) 75%),\n              linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.1) 75%)\n            ",backgroundSize:"40px 40px",backgroundPosition:"0 0, 0 20px, 20px -20px, -20px 0px"}})}),(0,s.jsxs)("div",{className:"absolute inset-0 opacity-5",children:[(0,s.jsx)("div",{className:"absolute top-20 left-10 w-32 h-32 bg-white rounded-full blur-3xl lg:w-40 lg:h-40"}),(0,s.jsx)("div",{className:"absolute bottom-40 right-10 w-40 h-40 bg-white rounded-full blur-3xl lg:w-48 lg:h-48"}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 bg-white rounded-full blur-2xl lg:w-32 lg:h-32"})]})]}),(0,s.jsxs)("div",{className:"relative z-10 flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 lg:px-8 pt-4 pb-2",children:[(0,s.jsx)("button",{onClick:()=>o.push("/"),className:"w-10 h-10 lg:w-12 lg:h-12 rounded-full overflow-hidden bg-white/20 border-2 border-white/30 hover:bg-white/30 transition-colors",children:r?(0,s.jsx)("img",{src:r,alt:"Profile",className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full bg-white/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-lg lg:text-xl font-bold",children:"U"})})}),(0,s.jsx)("div",{className:"flex-1 mx-4 lg:mx-8",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(x.Z,{className:"absolute left-3 lg:left-4 top-1/2 -translate-y-1/2 text-white/70",size:18}),(0,s.jsx)("input",{value:l,onChange:a,type:"text",placeholder:"Search",className:"w-full h-10 lg:h-12 pl-10 lg:pl-12 bg-white/20 text-white rounded-full placeholder-white/70 focus:outline-none focus:bg-white/30 border border-white/30 focus:border-white/50 transition-all text-sm lg:text-base"})]})}),(0,s.jsx)("div",{className:"w-10 h-10 lg:w-12 lg:h-12"})," "]}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto px-4 lg:px-8 pb-20 lg:pb-24 space-y-8 scrollbar-hide",children:t})]})]})},g=()=>{let[e,t]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{t(!0)},[]),e)?(0,s.jsxs)("div",{className:"bg-white/10 rounded-lg p-3 lg:p-4 text-white/70 text-xs lg:text-sm",children:[(0,s.jsxs)("div",{children:["認証状態: ",localStorage.getItem("access_token")?"ログイン中":"未ログイン"]}),(0,s.jsxs)("div",{children:["メール: ",localStorage.getItem("user_email")||"なし"]}),(0,s.jsxs)("div",{children:["ロール: ",localStorage.getItem("user_role")||"なし"]})]}):null};function p(){let e=(0,h.useRouter)(),[t,l]=(0,a.useState)(""),[o,x]=(0,a.useState)(new Set),[p,b]=(0,a.useState)([]),[f,v]=(0,a.useState)(!0),[w,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{let t=localStorage.getItem("access_token"),l=localStorage.getItem("user_email"),s=localStorage.getItem("user_id"),a=localStorage.getItem("user_type");if(console.log("localStorageの内容:",{accessToken:t?"存在 (".concat(t.substring(0,20),"...)"):"なし",userEmail:l,userId:s,userType:a,userIdType:typeof s,userIdLength:s?s.length:0}),console.log("認証情報詳細:",{hasAccessToken:!!t,accessTokenLength:t?t.length:0,hasUserEmail:!!l,hasUserId:!!s,hasUserType:!!a}),!t||!l){console.log("認証情報が不足しています。ログインページに移動します。"),e.push("/auth/login");return}if("coach"===a){console.log("コーチアカウントです。コーチホームに移動します。"),e.push("/coach/home");return}if(console.log("認証確認完了:",{hasToken:!!t,email:l,userType:a}),s&&t)try{let e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(!e.test(s)){console.error("無効なuser_id形式:",s),y("ユーザーIDの形式が無効です"),v(!1);return}if(!t.startsWith("mock_token_")){console.error("無効なaccess_token形式:",t),y("アクセストークンの形式が無効です"),v(!1);return}console.log("動画取得APIを呼び出し:",{url:"/api/user/videos?user_id=".concat(s),userId:s,hasToken:!!t,isUUID:e.test(s)});let l=await fetch("/api/user/videos?user_id=".concat(s),{headers:{Authorization:"Bearer ".concat(t)}});if(console.log("APIレスポンス:",{status:l.status,statusText:l.statusText,ok:l.ok}),l.ok){var r;let e=await l.json();console.log("取得した動画データ:",e),console.log("動画データの詳細:",{total_videos:e.total_videos,videos_by_club_keys:Object.keys(e.videos_by_club),recent_videos_count:(null===(r=e.recent_videos)||void 0===r?void 0:r.length)||0});let t=[];Object.values(e.videos_by_club).forEach(e=>{console.log("クラブ別動画:",e),t.push(...e)});let s=t.map(e=>{console.log("動画データ検証中:",{video_id:e.video_id,thumbnail_url:e.thumbnail_url,thumbnail_url_type:typeof e.thumbnail_url,club_type:e.club_type,swing_form:e.swing_form});let t=null;if(e.thumbnail_url&&"string"==typeof e.thumbnail_url)try{let l=new URL(e.thumbnail_url);"https:"===l.protocol&&l.hostname.includes("blob.core.windows.net")&&l.pathname.includes(".jpg")&&e.thumbnail_url.length>20?(t=e.thumbnail_url,console.log("✅ 有効なサムネイルURL:",e.thumbnail_url)):console.warn("⚠️ サムネイルURL検証失敗:",{url:e.thumbnail_url,protocol:l.protocol,hostname:l.hostname,pathname:l.pathname,length:e.thumbnail_url.length})}catch(t){console.warn("❌ サムネイルURL解析エラー:",{url:e.thumbnail_url,error:t instanceof Error?t.message:String(t)})}else console.warn("⚠️ サムネイルURLが不正:",{thumbnail_url:e.thumbnail_url,type:typeof e.thumbnail_url});return{...e,thumbnail_url:t}});console.log("検証済み動画データ:",s),console.log("各動画のサムネイルURL:",s.map(e=>e.thumbnail_url)),b(s)}else{console.error("動画取得失敗:",l.status,l.statusText);try{let e=await l.json();if(console.error("エラー詳細:",e),422===l.status){let t="動画の取得に失敗しました: バリデーションエラー (".concat(l.status,")");if(e.details&&e.details.detail){if(console.log("バリデーションエラー詳細:",e.details.detail),Array.isArray(e.details.detail)){let l=e.details.detail.map(e=>e.loc&&e.msg?"".concat(e.loc.join("."),": ").concat(e.msg):e.msg?e.msg:JSON.stringify(e)).join(", ");t+=" - ".concat(l)}else t+=" - ".concat(JSON.stringify(e.details.detail))}y(t)}else y("動画の取得に失敗しました: ".concat(e.error||"不明なエラー"," (").concat(l.status,")"))}catch(e){y("動画の取得に失敗しました (".concat(l.status,")"))}}}catch(e){console.error("動画取得エラー:",e),y("動画の取得中にエラーが発生しました")}v(!1)})()},[e]);let j=(0,a.useMemo)(()=>t.trim()?p.filter(e=>{var l,s;let a=(null===(l=e.club_type)||void 0===l?void 0:l.toLowerCase())||"",r=(null===(s=e.swing_form)||void 0===s?void 0:s.toLowerCase())||"",o=t.toLowerCase();return a.includes(o)||r.includes(o)}):p,[p,t]),N=(0,a.useMemo)(()=>{let e={driverWood:[],ironUtilWedge:[],putter:[]};return j.forEach(t=>{if(!t.club_type){console.warn("club_typeが設定されていない動画をスキップ:",t.video_id);return}let l=t.club_type.toLowerCase();["driver","wood"].includes(l)?e.driverWood.push(t):["iron","utility","wedge"].includes(l)?e.ironUtilWedge.push(t):"putter"===l?e.putter.push(t):(console.log("未分類のクラブタイプ:",l,"をdriverWoodに分類"),e.driverWood.push(t))}),e},[j]),k=e=>{x(t=>{let l=new Set(t);return l.has(e)?l.delete(e):l.add(e),l})},_=e=>{let{item:t}=e,l=(0,h.useRouter)();return(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl overflow-hidden video-card-hover cursor-pointer hover:bg-white/20 transition-all duration-200 hover:scale-105",onClick:()=>{console.log("動画カードがクリックされました:",t.video_id),l.push("/user/video/".concat(t.video_id))},children:[(0,s.jsxs)("div",{className:"relative",children:[t.thumbnail_url?(0,s.jsx)("img",{src:t.thumbnail_url,alt:"Video thumbnail",className:"w-full h-24 sm:h-28 md:h-32 lg:h-36 object-cover",onError:e=>{console.error("サムネイル読み込みエラー:",t.thumbnail_url),e.currentTarget.style.display="none"}}):(0,s.jsx)("div",{className:"w-full h-24 sm:h-28 md:h-32 lg:h-36 bg-white/20 flex items-center justify-center",children:(0,s.jsx)(r.Z,{className:"text-white/50",size:24})}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),k(t.video_id)},className:"absolute top-2 right-2 p-1 rounded-full bg-black/30 hover:bg-black/50 transition-colors",children:(0,s.jsx)(i,{className:"".concat(o.has(t.video_id)?"text-red-500 fill-current":"text-white"),size:16})})]}),(0,s.jsxs)("div",{className:"p-2 sm:p-3 lg:p-4",children:[(0,s.jsx)("div",{className:"text-white text-sm lg:text-base font-medium mb-2",children:t.club_type||"未設定"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:t.swing_form?t.swing_form.split(",").map((e,t)=>(0,s.jsx)("span",{className:"px-2 py-1 bg-white/20 text-white text-xs lg:text-sm rounded-full",children:e.trim()},t)):(0,s.jsx)("span",{className:"px-2 py-1 bg-white/20 text-white text-xs lg:text-sm rounded-full",children:"未設定"})}),(0,s.jsx)("div",{className:"text-white/70 text-xs lg:text-sm",children:new Date(t.upload_date).toLocaleDateString("ja-JP")})]})]})},S=e=>{let{title:t,items:l}=e;return(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-white text-2xl sm:text-3xl lg:text-4xl font-light mb-3",style:{fontFamily:"cursive"},children:t}),(0,s.jsx)("div",{className:"h-px bg-white/40 w-full mb-4"}),l.length>0?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"flex gap-3 lg:gap-4 overflow-x-auto pb-4 scrollbar-hide",children:l.map(e=>(0,s.jsx)("div",{className:"flex-shrink-0 w-36 sm:w-40 md:w-44 lg:w-48 xl:w-52",children:(0,s.jsx)(_,{item:e})},e.video_id))}),l.length>3&&(0,s.jsx)("div",{className:"flex justify-center mt-2",children:(0,s.jsx)("div",{className:"flex gap-1",children:Array.from({length:Math.ceil(l.length/3)},(e,t)=>(0,s.jsx)("div",{className:"w-2 h-2 bg-white/30 rounded-full scroll-indicator"},t))})})]}):(0,s.jsx)("div",{className:"text-center py-8 text-white/70 text-sm lg:text-base",children:"該当する動画がありません"})]})};return(0,s.jsxs)(m,{searchQuery:t,onSearchChange:e=>l(e.target.value),profileImageUrl:"https://images.pexels.com/photos/1325735/pexels-photo-1325735.jpeg?auto=compress&cs=tinysrgb&w=100",children:[(0,s.jsx)(g,{}),f&&(0,s.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 border-4 border-violet-500 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"ml-3 text-white text-base sm:text-lg lg:text-xl",children:"動画を読み込み中..."})]}),w&&!f&&(0,s.jsxs)("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 lg:p-6 text-center",children:[(0,s.jsx)("div",{className:"text-red-400 text-sm lg:text-base mb-2",children:"エラーが発生しました"}),(0,s.jsx)("div",{className:"text-red-300 text-xs lg:text-sm mb-3",children:w}),(0,s.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 lg:px-6 lg:py-3 bg-red-500 text-white rounded-lg text-sm lg:text-base hover:bg-red-600 transition-colors",children:"再読み込み"}),(0,s.jsx)("button",{onClick:()=>{localStorage.clear(),window.location.reload()},className:"px-4 py-2 lg:px-6 lg:py-3 bg-gray-600 text-white rounded-lg text-sm lg:text-base hover:bg-gray-700 transition-colors",children:"データリセット"})]})]}),!f&&!w&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"bg-gradient-to-r from-violet-500 to-purple-600 rounded-xl p-4 lg:p-6 text-white",children:[(0,s.jsx)("h3",{className:"text-lg lg:text-xl font-semibold mb-2",children:"ピンドリル"}),(0,s.jsx)("p",{className:"text-sm lg:text-base opacity-90 mb-3",children:"今日の練習メニューを確認しましょう"}),(0,s.jsx)("button",{className:"bg-white/20 hover:bg-white/30 px-4 py-2 lg:px-6 lg:py-3 rounded-lg text-sm lg:text-base transition-colors",children:"詳細を見る"})]}),{}),(0,s.jsx)(S,{title:"Driver / Wood",items:N.driverWood}),(0,s.jsx)(S,{title:"Iron / Utility / Wedge",items:N.ironUtilWedge}),(0,s.jsx)(S,{title:"Putter",items:N.putter})]}),(0,s.jsx)("nav",{className:"fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-[430px] lg:max-w-6xl xl:max-w-7xl bg-black/60 backdrop-blur-sm border-t border-white/10 z-50",children:(0,s.jsxs)("div",{className:"flex justify-around py-3 lg:py-4",children:[(0,s.jsxs)("button",{onClick:()=>e.push("/user/home"),className:"flex flex-col items-center space-y-1 text-violet-400",children:[(0,s.jsx)(n.Z,{size:20,className:"lg:w-6 lg:h-6"}),(0,s.jsx)("span",{className:"text-xs lg:text-sm",children:"ホーム"})]}),(0,s.jsxs)("button",{onClick:()=>e.push("/user/request"),className:"flex flex-col items-center space-y-1 text-white/70 hover:text-white",children:[(0,s.jsx)(c.Z,{size:20,className:"lg:w-6 lg:h-6"}),(0,s.jsx)("span",{className:"text-xs lg:text-sm",children:"添削依頼"})]}),(0,s.jsxs)("button",{onClick:()=>e.push("/user/mypage"),className:"flex flex-col items-center space-y-1 text-white/70 hover:text-white",children:[(0,s.jsx)(d.Z,{size:20,className:"lg:w-6 lg:h-6"}),(0,s.jsx)("span",{className:"text-xs lg:text-sm",children:"マイページ"})]}),(0,s.jsxs)("button",{onClick:()=>e.push("/user/settings"),className:"flex flex-col items-center space-y-1 text-white/70 hover:text-white",children:[(0,s.jsx)(u,{size:20,className:"lg:w-6 lg:h-6"}),(0,s.jsx)("span",{className:"text-xs lg:text-sm",children:"設定"})]})]})})]})}},1066:function(e,t,l){"use strict";l.d(t,{Z:function(){return o}});var s=l(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let l=(0,s.forwardRef)((l,o)=>{let{color:i="currentColor",size:n=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:u="",children:h,...x}=l;return(0,s.createElement)("svg",{ref:o,...a,width:n,height:n,stroke:i,strokeWidth:d?24*Number(c)/Number(n):c,className:["lucide","lucide-".concat(r(e)),u].join(" "),...x},[...t.map(e=>{let[t,l]=e;return(0,s.createElement)(t,l)}),...Array.isArray(h)?h:[h]])});return l.displayName="".concat(e),l}},2023:function(e,t,l){"use strict";l.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,l(1066).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},1005:function(e,t,l){"use strict";l.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,l(1066).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},8094:function(e,t,l){"use strict";l.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,l(1066).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},4817:function(e,t,l){"use strict";l.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,l(1066).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2022:function(e,t,l){"use strict";l.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,l(1066).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6463:function(e,t,l){"use strict";var s=l(1169);l.o(s,"useParams")&&l.d(t,{useParams:function(){return s.useParams}}),l.o(s,"useRouter")&&l.d(t,{useRouter:function(){return s.useRouter}})},2535:function(){}},function(e){e.O(0,[198,971,23,744],function(){return e(e.s=9286)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{1631:function(e,t,s){Promise.resolve().then(s.bind(s,1915))},1915:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var l=s(7437),i=s(2265),a=s(6463),n=s(8094),c=s(933),r=s(9338);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s(1066).Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var o=s(9936),h=s(869);function x(){let e=(0,a.useRouter)(),t=(0,a.useParams)().videoId,[s,x]=(0,i.useState)(null),[m,u]=(0,i.useState)(!0),[f,j]=(0,i.useState)(null);(0,i.useEffect)(()=>{let s=async()=>{let s=localStorage.getItem("access_token");if(!s){e.push("/auth/login");return}try{let e=await fetch("/api/video/".concat(t),{headers:{Authorization:"Bearer ".concat(s)}});if(e.ok){let l=await e.json();console.log("取得した動画基本情報:",l);let i=await fetch("/api/video/".concat(t,"/feedback-summary"),{headers:{Authorization:"Bearer ".concat(s)}}),a={feedback_sections:[],total_sections:0};i.ok&&(a=await i.json(),console.log("取得したフィードバック情報:",a));let n={video_id:l.video_id||t,thumbnail_url:l.thumbnail_url||l.thumbnail_file||"",video_url:l.video_url||l.video_file||"",upload_date:l.upload_date||l.created_at||"",club_type:l.club_type||"",swing_form:l.swing_form||"",swing_note:l.swing_note||"",has_feedback:a.total_sections>0,feedback_sections:a.feedback_sections||[]};console.log("構築された動画詳細:",n),x(n)}else console.error("動画基本情報の取得に失敗:",e.status),404===e.status?j("動画が見つかりません。APIエンドポイントを確認してください。"):j("動画情報の取得に失敗しました")}catch(e){console.error("動画詳細取得エラー:",e),j("動画詳細の取得中にエラーが発生しました")}finally{u(!1)}};t&&s()},[t,e]);let v=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/uploads/")||e.startsWith("uploads/")?"".concat("https://aps-bbc-02-dhdqd5eqgxa7f0hg.canadacentral-01.azurewebsites.net").concat(e.startsWith("/")?e:"/".concat(e)):e:"",b=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/uploads/")||e.startsWith("uploads/")?"".concat("https://aps-bbc-02-dhdqd5eqgxa7f0hg.canadacentral-01.azurewebsites.net").concat(e.startsWith("/")?e:"/".concat(e)):e:"",p=e=>({address:"アドレス",takeaway:"テイクバック",halfway_back:"ハーフウェイバック",backswing:"バックスイング",top:"トップ",transition:"切り返し",downswing:"ダウンスイング",impact:"インパクト",follow_through:"フォロースイング",finish_1:"フィニッシュ-1",finish_2:"フィニッシュ-2",other:"その他"})[e]||e,N=()=>{e.push("/user/home")};return m?(0,l.jsx)(o.T,{title:"読み込み中",subtitle:"動画詳細を取得しています",showBackButton:!0,onBackClick:N,children:(0,l.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,l.jsx)("div",{className:"w-8 h-8 border-4 border-violet-500 border-t-transparent rounded-full animate-spin"}),(0,l.jsx)("span",{className:"ml-3 text-white text-base",children:"動画詳細を読み込み中..."})]})}):f||!s?(0,l.jsx)(o.T,{title:"エラー",subtitle:"動画詳細の取得に失敗しました",showBackButton:!0,onBackClick:N,children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-white/70 text-base mb-6",children:f||"動画が見つかりません"}),(0,l.jsx)(h.Jr,{onClick:N,className:"w-full",children:"ホームに戻る"})]})}):(0,l.jsxs)(o.T,{title:"動画詳細",subtitle:"アップロードされた動画の詳細情報",showBackButton:!0,onBackClick:N,children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"relative rounded-2xl overflow-hidden bg-black",children:[s.video_url?(0,l.jsx)("video",{src:b(s.video_url),controls:!0,className:"w-full h-96 object-contain mx-auto",poster:s.thumbnail_url?v(s.thumbnail_url):void 0,onError:e=>{console.error("動画読み込みエラー:",e),e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&t.classList.remove("hidden")}}):null,(0,l.jsxs)("div",{className:"".concat(s.video_url?"hidden":""," w-full h-96 flex items-center justify-center"),children:[s.thumbnail_url?(0,l.jsx)("img",{src:v(s.thumbnail_url),alt:"動画サムネイル",className:"w-full h-96 object-contain",onError:e=>{console.error("サムネイル読み込みエラー:",s.thumbnail_url),e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&t.classList.remove("hidden")}}):null,(0,l.jsx)("div",{className:"".concat(s.thumbnail_url?"hidden":""," w-full h-96 bg-gray-800 flex items-center justify-center"),children:(0,l.jsxs)("div",{className:"text-white/50 text-center",children:[(0,l.jsx)(n.Z,{size:48}),(0,l.jsx)("div",{className:"text-sm mt-2",children:"動画がありません"})]})})]}),s.video_url&&(0,l.jsx)("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center pointer-events-none",children:(0,l.jsx)("div",{className:"text-white/70 text-sm",children:"動画プレイヤーで再生できます"})})]}),(0,l.jsxs)("div",{className:"text-white/50 text-xs mt-2 space-y-1",children:[(0,l.jsxs)("div",{children:["動画URL: ",s.video_url||"なし"]}),(0,l.jsxs)("div",{children:["サムネイルURL: ",s.thumbnail_url||"なし"]}),(0,l.jsxs)("div",{children:["変換後の動画URL: ",s.video_url?b(s.video_url):"なし"]}),(0,l.jsxs)("div",{children:["変換後のサムネイルURL: ",s.thumbnail_url?v(s.thumbnail_url):"なし"]})]})]}),(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-6 mb-6 border border-white/30",children:[(0,l.jsx)("h2",{className:"text-white text-lg font-medium mb-4",children:"動画情報"}),(0,l.jsxs)("div",{className:"space-y-3 text-white/90",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(c.Z,{size:16,className:"text-violet-400"}),(0,l.jsxs)("span",{children:["アップロード日: ",s.upload_date]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(r.Z,{size:16,className:"text-violet-400"}),(0,l.jsxs)("span",{children:["クラブ: ",s.club_type||"未設定"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d,{size:16,className:"text-violet-400"}),(0,l.jsxs)("span",{children:["スイング形式: ",s.swing_form||"未設定"]})]}),s.swing_note&&(0,l.jsxs)("div",{className:"pt-2 border-t border-white/20",children:[(0,l.jsx)("div",{className:"text-sm text-white/70 mb-1",children:"メモ:"}),(0,l.jsx)("div",{className:"text-white/90",children:s.swing_note})]})]})]}),(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/30",children:[(0,l.jsx)("h2",{className:"text-white text-lg font-medium mb-4",children:"コーチからのフィードバック"}),0===s.feedback_sections.length?(0,l.jsxs)("div",{className:"text-white/70 text-center py-8",children:[(0,l.jsx)(d,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,l.jsx)("div",{children:"まだフィードバックがありません"}),(0,l.jsx)("div",{className:"text-sm mt-2",children:"コーチが動画を確認すると、ここにフィードバックが表示されます"})]}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[(0,l.jsxs)("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[(0,l.jsx)(d,{size:20,className:"text-violet-400"}),"全体的な評価"]}),(0,l.jsxs)("div",{className:"text-white/90 text-sm leading-relaxed",children:["この動画では、スイングの基本的なフォームは良好ですが、いくつかの改善点があります。 特に、バックスイングでの手首の角度と、ダウンスイングでの体重移動に注目して練習することをお勧めします。",(0,l.jsx)("span",{className:"text-violet-300 font-medium",children:"Read More..."})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,l.jsx)(r.Z,{size:20,className:"text-violet-400"}),"スイングフェーズ別フィードバック",(0,l.jsxs)("span",{className:"text-white/50 text-sm font-normal ml-2",children:[s.feedback_sections.length," Steps"]})]}),(0,l.jsx)("div",{className:"space-y-4",children:s.feedback_sections.map((e,t)=>(0,l.jsx)("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-violet-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:(t+1).toString().padStart(2,"0")}),t<s.feedback_sections.length-1&&(0,l.jsx)("div",{className:"w-0.5 h-8 bg-violet-500/30 mt-2"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-white font-medium",children:p(e.tags[0])||"その他"}),(0,l.jsx)("span",{className:"text-white/50 text-xs",children:e.time_range})]}),(0,l.jsx)("span",{className:"px-2 py-1 text-xs text-violet-300 bg-violet-500/20 rounded-full",children:e.has_comment?"コメントあり":"コメントなし"})]}),e.tags.length>0&&(0,l.jsx)("div",{className:"flex gap-2 mb-3",children:e.tags.map((e,t)=>(0,l.jsx)("span",{className:"px-2 py-1 text-xs text-violet-600 bg-white rounded-full",children:p(e)},t))}),e.has_comment&&(0,l.jsxs)("div",{className:"bg-white/10 rounded-lg p-3",children:[(0,l.jsx)("div",{className:"text-white/90 text-sm leading-relaxed",children:e.comment_summary}),e.full_comment&&(0,l.jsxs)("details",{className:"mt-2",children:[(0,l.jsx)("summary",{className:"text-white/70 text-sm cursor-pointer hover:text-white/90",children:"詳細を見る"}),(0,l.jsx)("div",{className:"mt-2 text-white/90 text-sm leading-relaxed",children:e.full_comment})]})]})]})]})},e.section_id))})]}),(0,l.jsxs)("div",{className:"bg-gradient-to-r from-violet-500/20 to-purple-500/20 rounded-xl p-4 border border-violet-500/30",children:[(0,l.jsxs)("h3",{className:"text-white font-medium mb-4 flex items-center gap-2",children:[(0,l.jsx)(n.Z,{size:20,className:"text-violet-400"}),"ドリル練習メニュー",(0,l.jsx)("span",{className:"text-white/50 text-sm font-normal ml-2",children:"2つのポイントに絞った練習"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"bg-white/10 rounded-lg p-3",children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("div",{className:"w-6 h-6 bg-violet-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"1"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h4",{className:"text-white font-medium text-sm mb-1",children:"手首の角度を意識したバックスイング"}),(0,l.jsx)("p",{className:"text-white/80 text-sm leading-relaxed",children:"バックスイングで手首を適切にコックし、クラブシャフトが地面と平行になるように練習してください。 鏡の前でゆっくりと動作を確認しながら、正しい角度を身につけましょう。"})]})]})}),(0,l.jsx)("div",{className:"bg-white/10 rounded-lg p-3",children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("div",{className:"w-6 h-6 bg-violet-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"2"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h4",{className:"text-white font-medium text-sm mb-1",children:"体重移動のタイミング"}),(0,l.jsx)("p",{className:"text-white/80 text-sm leading-relaxed",children:"ダウンスイングで左足への体重移動を適切なタイミングで行い、インパクトで左足に体重が乗るように練習してください。 スローモーションで体重の移動を確認しながら、リズムを身につけましょう。"})]})]})})]})]})]})]})]})}},933:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(1066).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8094:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(1066).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},9338:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(1066).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])}},function(e){e.O(0,[137,971,23,744],function(){return e(e.s=1631)}),_N_E=e.O()}]);
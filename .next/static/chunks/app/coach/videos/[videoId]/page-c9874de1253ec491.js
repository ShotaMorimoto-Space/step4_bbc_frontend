(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{6211:function(e,s,t){Promise.resolve().then(t.bind(t,8715))},8715:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var l=t(7437),a=t(2265),i=t(6463),r=t(488),c=t(4410),n=t(8094),o=t(8954),d=t(2022),u=t(4241),x=t(1902),h=t(7390);function m(){let e=(0,i.useRouter)(),s=(0,i.useParams)().videoId,[t,m]=(0,a.useState)(null),[g,p]=(0,a.useState)(!0),[f,j]=(0,a.useState)(null),[v,w]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{(()=>{let s=localStorage.getItem("access_token"),t=localStorage.getItem("user_type");if(!s){e.push("/auth/login");return}if("coach"!==t){e.push("/user/home");return}})()},[e]),(0,a.useEffect)(()=>{let e=async()=>{try{var e,t;p(!0);let l=localStorage.getItem("access_token");if(!l){j("認証トークンがありません"),p(!1);return}let a=await fetch("".concat("https://aps-bbc-02-dhdqd5eqgxa7f0hg.canadacentral-01.azurewebsites.net/api/v1","/video/").concat(s,"/with-sections"),{headers:{Authorization:"Bearer ".concat(l)}});if(!a.ok){let e=await a.text();throw console.error("API呼び出しエラー:",a.status,e),Error("API呼び出しに失敗しました: ".concat(a.status))}let i=await a.json();console.log("取得した動画詳細:",i);let r={video_id:i.video_id,user_id:i.user_id,user_name:(null===(e=i.user)||void 0===e?void 0:e.username)||"Unknown User",user_email:(null===(t=i.user)||void 0===t?void 0:t.email)||"unknown@example.com",video_url:i.video_url,thumbnail_url:i.thumbnail_url,club_type:i.club_type,swing_form:i.swing_form,swing_note:i.swing_note,upload_date:i.upload_date,status:i.section_groups&&i.section_groups.length>0?"completed":"pending",priority:i.section_groups&&i.section_groups.length>0?"low":"high",user_profile:i.user?{golf_score_ave:i.user.golf_score_ave||0,golf_exp:i.user.golf_exp||"不明",sport_exp:i.user.sport_exp||"不明"}:void 0};m(r),j(null)}catch(e){console.error("動画詳細取得エラー:",e),j(e instanceof Error?e.message:"動画の詳細取得に失敗しました")}finally{p(!1)}};s&&e()},[s]),g)?(0,l.jsx)(r.d,{title:"Loading...",subtitle:"読み込み中...",showBackButton:!0,onBackClick:()=>e.push("/coach/videos"),backButtonText:"動画一覧",children:(0,l.jsx)("div",{className:"text-center py-12",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"})})}):f||!t?(0,l.jsx)(r.d,{title:"エラー",subtitle:"動画の読み込みに失敗しました",showBackButton:!0,onBackClick:()=>e.push("/coach/videos"),backButtonText:"動画一覧",children:(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("p",{className:"text-red-400 mb-4",children:f||"動画が見つかりません"}),(0,l.jsx)(c.rv,{onClick:()=>e.push("/coach/videos"),children:"動画一覧に戻る"})]})}):(0,l.jsx)(r.d,{title:"動画詳細",subtitle:"".concat(t.user_name," さんの動画"),showBackButton:!0,onBackClick:()=>e.push("/coach/videos"),backButtonText:"動画一覧",children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white/10 rounded-xl p-4",children:[(0,l.jsx)("h3",{className:"text-white text-lg font-medium mb-4",children:"動画プレビュー"}),(0,l.jsx)("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-video",children:v?(0,l.jsxs)("div",{className:"relative w-full h-full",children:[(0,l.jsx)("video",{src:t.video_url,controls:!0,autoPlay:!0,className:"w-full h-full object-contain",onError:e=>{console.error("動画再生エラー:",e),w(!1)}}),(0,l.jsx)("button",{onClick:()=>{console.log("動画再生停止"),w(!1)},className:"absolute top-2 right-2 bg-black/70 hover:bg-black/90 text-white rounded-full p-2 transition-colors",children:(0,l.jsx)(n.Z,{size:16,className:"rotate-90"})})]}):(0,l.jsxs)(l.Fragment,{children:[t.thumbnail_url?(0,l.jsx)("img",{src:t.thumbnail_url,alt:"動画サムネイル",className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(o.Z,{size:48,className:"text-white/40"})}),(0,l.jsx)("button",{onClick:()=>{t&&(console.log("動画再生開始:",t.video_url),w(!0))},className:"absolute inset-0 bg-black/30 flex items-center justify-center hover:bg-black/40 transition-colors",children:(0,l.jsx)("div",{className:"bg-white/90 rounded-full p-4",children:(0,l.jsx)(n.Z,{size:32,className:"text-gray-800 ml-1"})})})]})}),(0,l.jsxs)("div",{className:"mt-2 text-xs text-white/60",children:[(0,l.jsxs)("p",{children:["動画URL: ",t.video_url]}),(0,l.jsxs)("p",{children:["サムネイルURL: ",t.thumbnail_url||"なし"]})]})]}),(0,l.jsxs)("div",{className:"bg-white/10 rounded-xl p-4",children:[(0,l.jsx)("h3",{className:"text-white text-lg font-medium mb-4",children:"基本情報"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.Z,{size:16,className:"text-orange-400"}),(0,l.jsx)("span",{className:"text-white/80 text-sm",children:"ユーザー名"}),(0,l.jsx)("span",{className:"text-white font-medium",children:t.user_name})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(u.Z,{size:16,className:"text-orange-400"}),(0,l.jsx)("span",{className:"text-white/80 text-sm",children:"アップロード日時"}),(0,l.jsx)("span",{className:"text-white font-medium",children:new Date(t.upload_date).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(x.Z,{size:16,className:"text-orange-400"}),(0,l.jsx)("span",{className:"text-white/80 text-sm",children:"クラブ"}),(0,l.jsx)("span",{className:"bg-orange-500/20 px-2 py-1 rounded text-xs text-white",children:t.club_type})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-white/80 text-sm",children:"ステータス"}),(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white ".concat((e=>{switch(e){case"pending":return"bg-yellow-500";case"in_progress":return"bg-blue-500";case"completed":return"bg-green-500";default:return"bg-gray-500"}})(t.status)),children:(e=>{switch(e){case"pending":return"未対応";case"in_progress":return"対応中";case"completed":return"完了";default:return"不明"}})(t.status)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-white/80 text-sm",children:"優先度"}),(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white ".concat((e=>{switch(e){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}})(t.priority)),children:(e=>{switch(e){case"high":return"高";case"medium":return"中";case"low":return"低";default:return"不明"}})(t.priority)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"text-white/80 text-sm",children:"問題"}),(0,l.jsx)("span",{className:"bg-blue-500/20 px-2 py-1 rounded text-xs text-white",children:t.swing_form})]})]})]})]}),t.user_profile&&(0,l.jsxs)("div",{className:"bg-white/10 rounded-xl p-4",children:[(0,l.jsx)("h3",{className:"text-white text-lg font-medium mb-4",children:"ユーザープロフィール"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-white text-2xl font-bold",children:t.user_profile.golf_score_ave}),(0,l.jsx)("div",{className:"text-white/60 text-sm",children:"平均スコア"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-white text-lg font-medium",children:(e=>{switch(e){case"1年未満":return"1年未満";case"1-3年":return"1-3年";case"3-5年":return"3-5年";case"5-10年":return"5-10年";case"10年以上":return"10年以上";default:return e}})(t.user_profile.golf_exp)}),(0,l.jsx)("div",{className:"text-white/60 text-sm",children:"ゴルフ経験"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-white text-sm font-medium",children:t.user_profile.sport_exp}),(0,l.jsx)("div",{className:"text-white/60 text-sm",children:"スポーツ経験"})]})]})]}),t.swing_note&&(0,l.jsxs)("div",{className:"bg-white/10 rounded-xl p-4",children:[(0,l.jsx)("h3",{className:"text-white text-lg font-medium mb-4",children:"問題の詳細"}),(0,l.jsx)("div",{className:"bg-white/5 rounded-lg p-4",children:(0,l.jsx)("p",{className:"text-white/90 leading-relaxed",children:t.swing_note})})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 mb-40",children:[(0,l.jsxs)(c.rv,{onClick:()=>e.push("/coach/videos/".concat(s,"/feedback")),className:"w-full py-4 bg-blue-500 hover:bg-blue-600 text-lg font-semibold",children:[(0,l.jsx)(h.Z,{size:24}),"添削フィードバックを作成"]}),(0,l.jsx)(c.rv,{onClick:()=>e.push("/coach/videos"),variant:"secondary",className:"w-full py-4 text-lg font-semibold",children:"動画一覧に戻る"})]}),(0,l.jsx)("div",{className:"h-20"})]})})}},7390:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(1066).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},8094:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(1066).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},1902:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(1066).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},2022:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(1066).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[571,971,23,744],function(){return e(e.s=6211)}),_N_E=e.O()}]);
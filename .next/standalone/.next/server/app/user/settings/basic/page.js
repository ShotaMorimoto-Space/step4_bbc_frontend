(()=>{var e={};e.id=6186,e.ids=[6186],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4699:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),s(8525),s(9716),s(5866);var r=s(3191),a=s(8716),i=s(7922),n=s.n(i),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["user",{children:["settings",{children:["basic",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8525)),"/Users/morimotoshouta/Desktop/tech0/STEP4/BBC/bbc-golf-coaching-backend-ver2-main/frontend/app/user/settings/basic/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9716)),"/Users/morimotoshouta/Desktop/tech0/STEP4/BBC/bbc-golf-coaching-backend-ver2-main/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/morimotoshouta/Desktop/tech0/STEP4/BBC/bbc-golf-coaching-backend-ver2-main/frontend/app/user/settings/basic/page.tsx"],u="/user/settings/basic/page",h={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/user/settings/basic/page",pathname:"/user/settings/basic",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2002:(e,t,s)=>{Promise.resolve().then(s.bind(s,6955))},6955:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(326),a=s(7577),i=s(5047),n=s(4019),l=s(9635),o=s(1896),c=s(1215),d=s(8679),u=s(7869),h=s(6591);function x(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)({name:"",birthDate:"",gender:"",avatar:""}),[x,p]=(0,a.useState)(!1),[m,g]=(0,a.useState)(""),[b,f]=(0,a.useState)(""),v=e=>{let t=e.target.files?.[0];if(!t)return;if(t.size>5242880){f("ファイルサイズは5MB以下にしてください"),setTimeout(()=>f(""),5e3);return}if(!t.type.startsWith("image/")){f("画像ファイルを選択してください"),setTimeout(()=>f(""),5e3);return}let r=new FileReader;r.onload=e=>{let t=e.target?.result;s(e=>({...e,avatar:t}))},r.readAsDataURL(t),e.target.value=""},j=async()=>{p(!0),f("");try{let s=(0,h.le)("access_token"),r=(0,h.le)("user_id");if(console.log("認証情報確認:",{accessToken:s?"あり":"なし",userId:r||"なし"}),!s)throw Error("アクセストークンが不足しています");let a=r;if(!a&&(0,h.le)("user_email"))try{let e=await fetch("/api/auth/me",{headers:{Authorization:`Bearer ${s}`}});if(e.ok){let t=await e.json();console.log("/api/auth/meレスポンス詳細:",t);let s=null;t.profile&&t.profile.user_id?s=t.profile.user_id:t.user_id?s=t.user_id:t.id&&(s=t.id),s?(a=s,console.log("APIから取得したユーザーID:",s)):console.warn("/api/auth/meレスポンスにuser_idが含まれていません:",t)}else console.error("ユーザーID取得失敗:",e.status,e.statusText)}catch(e){console.error("ユーザーID取得エラー:",e)}if(!a)throw Error("ユーザーIDが取得できません");let i={username:t.name,gender:t.gender,birthday:t.birthDate,profile_picture_url:t.avatar};console.log("送信データ:",{...i,user_id:a});let n=await fetch("/api/auth/user/profile",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...i,user_id:a})});if(console.log("APIレスポンス:",{status:n.status,statusText:n.statusText,ok:n.ok}),!n.ok){console.error("APIレスポンスエラー:",{status:n.status,statusText:n.statusText,url:n.url});let e="基本情報の更新に失敗しました";try{let t=await n.json();console.error("エラーレスポンス詳細:",t),e=t.detail||t.message||e}catch(t){console.error("エラーレスポンスのパースに失敗:",t);let e=await n.text();console.error("エラーレスポンス（テキスト）:",e)}throw Error(e)}(0,h.D$)("user_name",t.name),(0,h.D$)("user_gender",t.gender),(0,h.D$)("user_birth_date",t.birthDate),(0,h.D$)("user_avatar",t.avatar),g("基本情報が更新されました"),setTimeout(()=>{e.push("/user/settings")},1500)}catch(e){console.error("基本情報更新エラー:",e),f(e.message||"基本情報の更新に失敗しました"),setTimeout(()=>f(""),5e3)}finally{p(!1)}};return(0,r.jsxs)(d.d,{title:"基本情報編集",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 pt-4 pb-2",children:[r.jsx("button",{onClick:()=>e.push("/user/settings"),className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center",children:r.jsx(n.Z,{size:20,className:"text-white"})}),r.jsx("h1",{className:"text-white text-lg font-medium",children:"基本情報編集"}),r.jsx("div",{className:"w-10"})," "]}),(0,r.jsxs)("main",{className:"flex-1 overflow-y-auto px-4 pb-4",children:[m&&r.jsx(u.Ou,{message:m}),b&&r.jsx(u.Ou,{message:b}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-500/20 border border-blue-500/30 rounded-lg text-blue-300 text-xs",children:[r.jsx("div",{children:"デバッグ情報:"}),(0,r.jsxs)("div",{children:["アクセストークン: ",(0,h.le)("access_token")?"あり":"なし"]}),(0,r.jsxs)("div",{children:["ユーザーID: ",(0,h.le)("user_id")||"なし"]}),(0,r.jsxs)("div",{children:["メール: ",(0,h.le)("user_email")||"なし"]})]}),(0,r.jsxs)("div",{className:"bg-white/10 rounded-2xl p-6",children:[r.jsx("h3",{className:"text-white text-lg font-medium mb-6",children:"基本情報"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{onClick:()=>document.getElementById("avatar-input")?.click(),className:"w-20 h-20 rounded-full bg-white/20 flex items-center justify-center overflow-hidden cursor-pointer hover:bg-white/30 transition-colors relative group",children:[t.avatar?r.jsx("img",{src:t.avatar,alt:"Avatar",className:"w-full h-full object-cover"}):r.jsx(l.Z,{size:32,className:"text-white/70"}),r.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:r.jsx(o.Z,{size:24,className:"text-white"})})]}),r.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",onChange:e=>v(e),className:"hidden"}),(0,r.jsxs)("div",{className:"text-white/70 text-sm",children:["画像をタップして",r.jsx("br",{}),"変更できます"]})]}),r.jsx("div",{children:r.jsx(u.ic,{label:"名前",type:"text",value:t.name,onChange:e=>s(t=>({...t,name:e.target.value})),placeholder:"名前を入力"})}),r.jsx("div",{children:r.jsx(u.ic,{label:"生年月日",type:"date",value:t.birthDate,onChange:e=>s(t=>({...t,birthDate:e.target.value}))})}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"性別"}),(0,r.jsxs)("select",{value:t.gender,onChange:e=>s(t=>({...t,gender:e.target.value})),className:"w-full px-3 py-2 bg-white/20 text-white rounded-lg border border-white/20 focus:outline-none focus:border-white/40",children:[r.jsx("option",{value:"",children:"選択してください"}),r.jsx("option",{value:"male",children:"男性"}),r.jsx("option",{value:"female",children:"女性"}),r.jsx("option",{value:"other",children:"その他"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-8",children:[(0,r.jsxs)(u.Jr,{onClick:j,disabled:x,className:"flex-1 flex items-center justify-center gap-2",children:[r.jsx(c.Z,{size:16}),x?"保存中...":"保存"]}),(0,r.jsxs)(u.Jr,{variant:"secondary",onClick:()=>e.push("/user/settings"),className:"flex-1 flex items-center justify-center gap-2",children:[r.jsx(n.Z,{size:16}),"キャンセル"]})]})]})]})]})}},1896:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},1215:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},9635:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4019:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(6557).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6591:(e,t,s)=>{"use strict";s.d(t,{D$:()=>a,ZL:()=>i,le:()=>r});let r=e=>null,a=(e,t)=>{},i=()=>{}},8525:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=s(8570);let a=(0,r.createProxy)(String.raw`/Users/morimotoshouta/Desktop/tech0/STEP4/BBC/bbc-golf-coaching-backend-ver2-main/frontend/app/user/settings/basic/page.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let l=(0,r.createProxy)(String.raw`/Users/morimotoshouta/Desktop/tech0/STEP4/BBC/bbc-golf-coaching-backend-ver2-main/frontend/app/user/settings/basic/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,4471,9727],()=>s(4699));module.exports=r})();